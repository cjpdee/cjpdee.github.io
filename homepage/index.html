<!doctype HTML>
<html lang="en">

<head>
	<title>Tao Te Ching</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
:root {
	--c-text: #fff;
	--c-text-faded: #999999;
	--c-bg: #000;
	--c-bg-faded: #222;
}

* {
	margin: 0;
	padding: 0;
	box-sizing: border-box;
	font-family: system-ui, sans-serif;
	list-style: none;
}

html {
	background: var(--c-bg);
}

body {
	font-size: 16px;
	color: var(--c-text);
}

.page {
	width: 100%;
	padding: 24px;
	margin: 0 auto;
}

.page__header {
	display: flex;
	align-items: start;
	justify-content: space-between;
	width: 100%;
	margin-bottom: 0.5rem;
}

.page__chapter-title {
	text-align: left;
	font-size: 2rem !important;
	padding: 8px !important;
	margin: -8px !important;
	color: var(--c-text-faded);
	margin-bottom: 8px;
	font-weight: 200;
}

.page__book-title {
	font-size: 1rem;
	font-weight: 300;
	color: var(--c-text-faded);
}

button#nav-toggle {
	background: none;
	border: none;
	color: var(--c-text-faded);
	font-size: 1rem;
	cursor: pointer;

}

button#nav-toggle:after {
	content: '▼';
	margin-left: 0.5rem;
}

button#nav-toggle:hover, button#nav-toggle.is-active {
	color: var(--c-text);
}

.modal {
	position: fixed;
	top: 0;
	left: 0;
	align-items: center;
	justify-content: center;
	max-width: none;
	width: 100vw;
	min-height: 100vh;
	padding: 24px;
	background: rgba(0, 0, 0, 0.5);
	pointer-events: none;
}

.modal[open] {
	pointer-events: auto;
	display: flex;
}

.modal__inner {
	background: var(--c-bg);
	padding: 24px;
	width: 100%;
	max-width: 480px;
	border: 1px solid var(--c-bg-faded);
	border-radius: 8px;
	color: var(--c-text);
}

.modal__nav {
	display: flex;
	align-items: center;
	justify-content: space-between;
	width: 100%;
}

.nav-button {
	display: flex;
	align-items: center;
	justify-content: center;
	height: 40px;
	width: 40px;
	background: none;
	border: none;
	border-radius: 4px;
	color: var(--c-text-faded);
	font-size: 2rem;
	padding: 8px;
	padding-bottom: 12px;
	line-height: 0;
	cursor: pointer;
}

.nav-button:hover {
	color: var(--c-text);
	background: var(--c-bg-faded);
}

.nav-button--main {
	@media (max-width: 600px) {
		position: fixed;
		top: 80px;
		bottom: 0;
		height: calc(100vh - 80px);
		width: 48px;
		opacity: 0;
		&:hover {
			background: transparent;
		}
		&:active {
			background: rgba(0, 0, 0, 0.5);
			opacity: 0.5;
		}

		&#prev {
			left: 0;
		}
		&#next {
			right: 0;
		}
	}
}

& select {
	padding: 8px 16px 8px 8px;
	background: none;
	border: none;
	color: var(--c-text);
	font-size: 1.5rem;
	font-weight: 300;
	border-radius: 4px;
	cursor: pointer;
}
& select:hover {
	background: var(--c-bg-faded);
}
& select:focus-within {
	background: var(--c-bg-faded);
}

.modal__header {
	margin-bottom: 1rem;
}

hr {
	border: 1px solid var(--c-bg-faded);
	border-top: none;
	margin: 1.25rem 0;
}

h4 {
	font-size: 1.25rem;
	font-weight: 300;
	margin-bottom: 1rem;
}

#reading-list {
	margin: 0 -8px;
}

label {
	display: flex;
	align-items: center;
	justify-content: start;
	gap: 8px;
	width: 100%;
	padding: 8px;
	border-radius: 4px;
	background: var(--c-bg);
	color: var(--c-text-faded);
	cursor: pointer;
	margin-bottom: 4px;
	line-height: 0;

	&:active {
		background: var(--c-bg-faded);
		color: var(--c-text);
	}
	@media (min-width: 600px) {
		&:hover {
			background: var(--c-bg-faded);
			color: var(--c-text);
		
		}
	}

	li:first-child & {
		border-top-left-radius: 16px;
		border-top-right-radius: 16px;
	}

	li:last-child & {
		border-bottom-left-radius: 16px;
		border-bottom-right-radius: 16px;
	}
}

input[type="checkbox"] {
	position: relative;
	width: 16px;
	height: 16px;
	appearance: none;
	accent-color: var(--c-bg-faded);
	background: var(--c-bg-faded);
	border-radius: 2px;

	&:checked {
		appearance: revert;
	}

	li label:hover & {
		@media (min-width: 600px) {
			background: var(--c-bg);
			accent-color: var(--c-bg);
		}
	}
}

.page__chapter-content {
	max-width: 640px;
	width: 100%;
	white-space: pre-wrap;
	font-size: 1rem;
	letter-spacing: 0.02em;
	line-height: 1.75;
	font-weight: 400;
}

@media (min-width: 600px) {
	html {
		min-height: 100vh;
		background: linear-gradient(135deg, var(--c-bg) 30%, #0d0d0d 100%);
	}
	body {
		justify-content: start;
	}
	p {
		font-size: 1.25rem;
		font-weight: 200;
	}

	p.is-long {

	}
}
</style>
</head>

<body>
	<main class="page">
		<header class="page__header">

			<select  class="page__chapter-title"
				 id="chapter-select"
				 onchange="(() => {
				 setChapter(currentBook.id, currentBook.translation_id, event.target.selectedIndex)
				 })()"
				 >
			</select>

			<h1 class="page__book-title">
				<button 
					id="nav-toggle"
					aria-haspopup="dialog"
					aria-controls="nav-dialog"
					aria-expanded="false"
					onclick="document.querySelector('#nav-dialog').showModal()"
				>
				</button>
			</h1>
		</header>
		<p class="page__chapter-content" id="chapter-container"></p>
		<nav style="position: fixed; right: 24px; bottom: 24px; display: flex; align-items: center; justify-content: end; gap: 8px;">
			<button 
				class="nav-button nav-button--main"
				onclick="(() => { 
					setChapter(currentBook.id, currentBook.translation_id, currentChapter - 1)
				})()"
				id="prev"
			>&#x25C0;</button>
			<button 
				class="nav-button nav-button--main"
				onclick="(() => {
					setChapter(currentBook.id, currentBook.translation_id, currentChapter + 1)
				})()"
				id="next"
			>&#x25B6;</button>
		</nav>
	</main>
	<dialog id="nav-dialog" class="modal" onclick="(() => {
		if ((event.target.contains(document.querySelector('#nav-dialog')))) {
			document.querySelector('#nav-dialog').close()
		}
	})()">
		<div id="nav-inner" class="modal__inner">
			<header class="modal__header">
				<select 
					id="book-select"
					onchange="(() => {
						setBook(event.target.value, BOOKS_AVAILABLE.find(book => book.id === event.target.value).translation_id)
					})()"
					style="width: calc(100% + 24px); margin-left: -12px; margin-bottom: 0.25rem;"
				>
					<option></option>
				</select>
				<address id="author" rel="author" style="line-height: 1.5; position: relative; z-index: 1; pointer-events: none;"></address>
				<select 
					id="translation-select"
					onchange="(() => {
						setBook(currentBook.id, event.target.value)
					})()"
					style="
						width: calc(100% + 24px);
						margin-left: -12px;
						font-size: 1rem;
						margin-top: -2rem;
						padding-top: 1.5rem;
						padding-bottom: 0.25rem;
					"
				>
					<optgroup label="Translations">
					</optgroup>
				</select>
				</span>
				<address rel="author"></cite>
			</header>
			<nav class="modal__nav">
				<button 
					class="nav-button"
					onclick="(() => { 
						setChapter(currentBook.id, currentBook.translation_id, currentChapter - 1)
					})()"
					id="prev"
				>&#x25C0;</button>
				<select
					id="chapter-select"
					onchange="(() => {
						setChapter(currentBook.id, currentBook.translation_id, event.target.selectedIndex)
						document.querySelector('#nav-dialog').close()
					})()"
				>
					<option>Chapter 1</option>
				</select>
				<button 
					class="nav-button"
					onclick="(() => {
						setChapter(currentBook.id, currentBook.translation_id, currentChapter + 1)
					})()"
					id="next"
				>&#x25B6;</button>
			</nav>
			<hr />
			<h4>Reading list</h4>
			<ul id="reading-list">
				<li>
					<label>
						<input type="checkbox" value="tao-te-ching" />
						Tao Te Ching 道德經
					</label>
				</li>
				<li>
					<label>
						<input type="checkbox" value="tao-te-ching" />
						Meditations
					</label>
				</li>
			</ul>
		</div>
	</dialog>
</body>

<script async="true" src="./script.js"></script>

</html>
